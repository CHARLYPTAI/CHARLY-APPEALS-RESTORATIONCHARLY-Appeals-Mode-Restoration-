<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Tax Appeal Certificate - {{ property_data.address }}</title>
    <style>
        @page {
            size: A4;
            margin: 0.75in;
            @top-center {
                content: "OFFICIAL CERTIFICATE OF APPEAL RESOLUTION";
                font-size: 12px;
                font-weight: bold;
                color: #333;
            }
            @bottom-center {
                content: "Certificate ID: {{ certificate_id }} | Page " counter(page);
                font-size: 9px;
                color: #666;
            }
        }
        
        body {
            font-family: 'Times New Roman', serif;
            font-size: 12px;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 20px 0;
        }
        
        .certificate-container {
            border: 3px solid #1e40af;
            border-radius: 8px;
            padding: 40px;
            margin: 20px 0;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #1e40af;
            padding-bottom: 20px;
        }
        
        .certificate-title {
            font-size: 24px;
            font-weight: bold;
            color: #1e40af;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .certificate-subtitle {
            font-size: 16px;
            color: #64748b;
            font-style: italic;
        }
        
        .firm-logo {
            max-height: 60px;
            margin-bottom: 20px;
        }
        
        .certificate-body {
            margin: 30px 0;
            text-align: justify;
        }
        
        .property-info {
            background: #ffffff;
            border: 1px solid #e2e8f0;
            border-radius: 6px;
            padding: 20px;
            margin: 25px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        
        .property-info h3 {
            color: #1e40af;
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 16px;
            border-bottom: 1px solid #e2e8f0;
            padding-bottom: 8px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 15px 0;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dotted #cbd5e1;
        }
        
        .info-label {
            font-weight: bold;
            color: #475569;
        }
        
        .info-value {
            color: #1e293b;
            text-align: right;
        }
        
        .savings-highlight {
            background: #dcfce7;
            border: 2px solid #16a34a;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            text-align: center;
        }
        
        .savings-amount {
            font-size: 28px;
            font-weight: bold;
            color: #16a34a;
            margin: 10px 0;
        }
        
        .signatures {
            margin-top: 40px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
        }
        
        .signature-block {
            text-align: center;
            border-top: 2px solid #1e40af;
            padding-top: 10px;
        }
        
        .signature-line {
            width: 100%;
            height: 40px;
            margin-bottom: 10px;
        }
        
        .official-seal {
            position: absolute;
            top: 50px;
            right: 50px;
            width: 100px;
            height: 100px;
            border: 3px solid #dc2626;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(220, 38, 38, 0.1);
            font-size: 12px;
            font-weight: bold;
            color: #dc2626;
            text-align: center;
            line-height: 1.2;
        }
        
        .certificate-footer {
            margin-top: 40px;
            text-align: center;
            font-size: 10px;
            color: #64748b;
            border-top: 1px solid #e2e8f0;
            padding-top: 15px;
        }
        
        .verification-code {
            font-family: 'Courier New', monospace;
            background: #f1f5f9;
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #cbd5e1;
        }
        
        @media print {
            .certificate-container {
                box-shadow: none;
                border: 2px solid #1e40af;
            }
        }
    </style>
</head>
<body>
    <div class="certificate-container">
        <div class="official-seal">
            OFFICIAL<br>
            CERTIFIED<br>
            DOCUMENT
        </div>
        
        <div class="header">
            {% if firm_logo %}
            <img src="{{ firm_logo }}" alt="{{ firm_name }}" class="firm-logo">
            {% endif %}
            <div class="certificate-title">Certificate of Appeal Resolution</div>
            <div class="certificate-subtitle">Property Tax Assessment Reduction</div>
        </div>
        
        <div class="certificate-body">
            <p><strong>TO WHOM IT MAY CONCERN:</strong></p>
            
            <p>This certificate serves as official documentation that the property tax appeal for the below-described property has been <strong>SUCCESSFULLY RESOLVED</strong> in favor of the property owner. This appeal was professionally prepared and filed by {{ firm_name }} and has resulted in a significant reduction in the property's assessed value.</p>
            
            <div class="property-info">
                <h3>Property Information</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Property Address:</span>
                        <span class="info-value">{{ property_data.address }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Appeal ID:</span>
                        <span class="info-value">{{ case_number }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Jurisdiction:</span>
                        <span class="info-value">{{ jurisdiction }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Property Owner:</span>
                        <span class="info-value">{{ client_name }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Filing Date:</span>
                        <span class="info-value">{{ filing_date }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Resolution Date:</span>
                        <span class="info-value">{{ resolution_date }}</span>
                    </div>
                </div>
            </div>
            
            <div class="property-info">
                <h3>Assessment Details</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Original Assessment:</span>
                        <span class="info-value">{{ format_currency(original_assessment) }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Final Assessment:</span>
                        <span class="info-value">{{ format_currency(final_assessment) }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Assessment Reduction:</span>
                        <span class="info-value">{{ format_currency(assessment_reduction) }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Reduction Percentage:</span>
                        <span class="info-value">{{ format_percentage(reduction_percentage) }}</span>
                    </div>
                </div>
            </div>
            
            <div class="savings-highlight">
                <h3 style="margin: 0; color: #16a34a;">TOTAL ANNUAL TAX SAVINGS</h3>
                <div class="savings-amount">{{ format_currency(annual_tax_savings) }}</div>
                <p style="margin: 10px 0 0 0; font-style: italic;">
                    Based on effective tax rate of {{ format_percentage(tax_rate) }}
                </p>
            </div>
            
            <p><strong>CERTIFICATION:</strong> We hereby certify that this appeal was conducted in accordance with all applicable laws and regulations governing property tax assessments. The reduction in assessed value reflects the true and fair market value of the property as determined through professional valuation analysis and comparable market data.</p>
            
            <p>This certificate may be used for mortgage refinancing, property records, and other official purposes requiring documentation of the property's current assessed value.</p>
        </div>
        
        <div class="signatures">
            <div class="signature-block">
                <div class="signature-line"></div>
                <strong>{{ professional_name }}</strong><br>
                {{ professional_title }}<br>
                {{ firm_name }}<br>
                License: {{ professional_license }}
            </div>
            <div class="signature-block">
                <div class="signature-line"></div>
                <strong>Date</strong><br>
                {{ format_date(certificate_date) }}
            </div>
        </div>
        
        <div class="certificate-footer">
            <p><strong>Certificate Verification:</strong> <span class="verification-code">{{ certificate_id }}</span></p>
            <p>This document was electronically generated by the CHARLY Property Tax Appeals Platform.<br>
            For verification or questions, contact {{ firm_name }} or visit our online verification portal.</p>
            <p><em>{{ generation_time }}</em></p>
        </div>
    </div>
</body>
</html>